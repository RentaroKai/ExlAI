# ExlAI

## エクセル風AIアシスタント - 基本ガイド

**ExlAI**は、エクセル感覚でAI処理ができるアプリです。　　
こんな感じで処理したいな～! というテンプレートを入力したら、後はAIが一括処理します！

### このアプリで何ができるの？

- 「元の値」をAIが処理して、隣の列にデータを自動入力してくれます　　
　例：名前を名字と名前に分離する・文章を校正する・文章のフォーマットを指定の形に揃える　など
- 一度ルールを作れば、同じパターンのデータを一括処理できます
- CSVファイルの読み込み・保存ができます

### 使い方の手順

1. **アプリを起動する**
   - `run_app.bat`をダブルクリックするだけです

2. **テンプレートを作る**
   - 上部の「テンプレート」エリアに例を入力します
   - 1列目(A列)：AIに処理させたい元の値を入力
   - 2列目以降(B列～)：AIに生成させたい項目の名前を入力
   - サンプルとなる入力と出力の例を1行以上入力します

3. **ルールを作る**
   - 右側パネルの「テンプレートからルール生成」ボタンをクリック
   - しばらく待つと、AIがパターンを学習してルールを作成します

4. **データを処理する**
   - 下部の「データ入力エリア」に処理したいデータを入力します（緑の枠がついた所に入力）
   - A列に元の値を入力します（ペーストでOK）
   - 「選択行だけ処理」または「未処理を一括処理」ボタンをクリック
   - AIが処理結果を各列に自動入力します

5. **結果を保存する**
   - 「ファイル」メニュー→「CSV保存」を選択
   - 保存先を指定すれば完了です

### 困ったときは？

- 処理に失敗した場合は「エラー」と表示されます
- 「ログファイルを開く」を選ぶと詳細な情報が確認できます
- テンプレートを直して「再生成」ボタンを押してルールを作り直せます
- ルールを手で直したい場合は、履歴から選んで、詳細編集ボタンを押してください

---

## 開発者向け技術情報

### 技術スタック

- **言語**: Python 3.x
- **UI**: PySide6 (Qt for Python)
- **AIエンジン**: Gemini API (google-genai)
- **データ処理**: 標準CSV

### プロジェクト構造

```
ExlAI
  ├── app/              # アプリケーションコード
  │   ├── services/     # APIやルール処理ロジック
  │   └── ui/           # UIコンポーネント
  ├── utils/            # ユーティリティ関数
  ├── doc/              # ドキュメント
  └── run_app.bat       # 起動スクリプト
```

### コアコンポーネント

- **integrated_ui.py**: メインウィンドウとパネル統合
- **excel_panel.py**: エクセル風UIとデータテーブル
- **ai_panel.py**: AIルール管理と処理操作
- **rule_service.py**: ルール生成と適用ロジック

### 環境構築

```bash
# 依存関係のインストール
pip install -r requirements.txt

# 起動
python -m app.ui.integrated_ui
```

### 拡張開発

1. **新規モデル対応**: `gemini_api.py`を拡張してください
2. **ルール生成ロジック**: `rule_service.py`の`create_rule`メソッドを参照
3. **UI拡張**: PySide6を使用したコンポーネント設計に従ってください

### API統合

AIモデルの設定は`config.json`で行います。APIキーなどの環境設定を構成できます。

### コントリビューション

プルリクエストは歓迎です。新機能の追加や改善提案は、事前にIssueでディスカッションすることをお勧めします。
