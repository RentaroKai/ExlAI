![img](ExlAI.jpg)

# ExlAI

## エクセル風AIアシスタント - 基本ガイド

**ExlAI**は、エクセル感覚で簡単にAI処理ができる便利なアプリケーションです。  
「こんなふうに処理できたらいいな」というイメージを入力するだけで、  
AIが自動的にデータを一括処理してくれます！  

### このアプリで何ができるの？

- エクセルの関数では実現が難しい複雑なデータ処理をAIが自動的に行います
- 具体的な例：
  - 氏名を姓と名に分割する
  - 文章の誤字脱字をチェックして修正する
  - 文章を適切な表現に校正する
  - 様々なフォーマットのデータを統一された形式に整える
- 一度ルールを作成すれば、同じパターンのデータを何度でも一括処理できます
- CSVファイルを簡単に読み込んだり保存したりできます（Excel形式と互換性あり）

### 使い方の手順

1. **アプリを起動する**
    https://github.com/RentaroKai/ExlAI/releases
    ここから最新のexeをダウンロードして実行します


2. **Gemini APIの無料APIキーを取得する**
   - https://aistudio.google.com/app/apikey にアクセスして無料のAPIキーを作成できます
   - 作成したAPIキーはアプリの「設定」メニューから入力してください
   - **重要**: 無料プランではFlashモデル（gemini-2.0-flash-exp等）のみ利用可能です
   - 設定画面でモデルを「Flash」系に変更してください（Proモデルは有料プランが必要）

3. **テンプレートを作成する**
   - 上部の「テンプレート」エリアに例を入力します
   - 1列目(A列)：AIに処理させたい元のデータを入力します
   - 2列目以降(B列～)：AIに生成させたい項目の名前を入力します
   - サンプルとなる入力と出力の例を最低1行入力してください

4. **AIルールを生成する**
   - 右側パネルの「テンプレートからルール生成」ボタンをクリックします
   - しばらく待つと、AIがパターンを学習してルールを自動作成します

5. **データを処理する**
   - 下部の「データ入力エリア」（緑枠で囲まれた部分）に処理したいデータを入力します
   - A列に元の値を入力します（コピー＆ペーストでOK）
   - 「選択行だけ処理」または「未処理を一括処理」ボタンをクリックします
   - AIが処理結果を各列に自動入力します

6. **結果を保存する**
   - メニューバーの「ファイル」→「CSV保存」を選択します
   - 保存先を指定すれば完了です
   - 最後に処理したデータは自動的にCSV形式でバックアップされており、メニューからいつでも開くことができます

### 困ったときは？

- 処理に失敗した場合は「エラー」と表示されます
- **「403 Forbidden」エラーの場合**: 無料プランでProモデルを使用している可能性があります。設定でFlashモデルに変更してください
- エラーが発生した際のポップアップ画面で「ログファイルを開く」ボタンを押すと詳細情報を確認できます
- テンプレートを修正して「ルール再生成」ボタンを押せば、ルールを作り直すことができます
- ルールを手動で編集したい場合は、履歴から選択して「詳細編集」ボタンをクリックしてください

### 注意点

- **モデル制限**: 無料プランではFlashモデルのみ利用可能
- **Proモデル**: gemini-proは有料プランでのみ利用可能
- Gemini APIキーは無料で使用できますが、入力データはGoogleの学習データとして使用される可能性があります
- プライバシーやデータの機密性が重要な場合は、有料のAPIキーへの切り替えをご検討ください

---

## 開発者向け技術情報

### 技術スタック

- **言語**: Python 3.x
- **UI**: PySide6 (Qt for Python)
- **AIエンジン**: Gemini API (google-genai)
- **データ処理**: 標準CSV

### プロジェクト構造

```
ExlAI
  ├── app/              # アプリケーションコード
  │   ├── services/     # APIやルール処理ロジック
  │   └── ui/           # UIコンポーネント
  ├── utils/            # ユーティリティ関数
  ├── doc/              # ドキュメント
  └── run_app.bat       # 起動スクリプト
```

### コアコンポーネント

- **integrated_ui.py**: メインウィンドウとパネル統合
- **excel_panel.py**: エクセル風UIとデータテーブル
- **ai_panel.py**: AIルール管理と処理操作
- **rule_service.py**: ルール生成と適用ロジック

### 環境構築

```bash
# 依存関係のインストール
pip install -r requirements.txt

# 起動
python -m app.ui.integrated_ui
```

### 拡張開発

1. **新規モデル対応**: `gemini_api.py`を拡張してください
2. **ルール生成ロジック**: `rule_service.py`の`create_rule`メソッドを参照
3. **UI拡張**: PySide6を使用したコンポーネント設計に従ってください

### API統合

AIモデルの設定は`config.json`で行います。APIキーなどの環境設定を構成できます。

**対応モデル**:
- **無料プラン対応**: gemini-2.0-flash-exp, gemini-1.5-flash等のFlashモデル
- **有料プラン専用**: gemini-pro, gemini-pro-vision等のProモデル


## パッケージング
pyinstaller --clean ExlAI.spec